var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,l=(e,t)=>{for(var a in t||(t={}))n.call(t,a)&&o(e,a,t[a]);if(s)for(var a of s(t))r.call(t,a)&&o(e,a,t[a]);return e},i=(e,s)=>t(e,a(s));import{J as c,K as u,C as d,S as f,i as h,s as m,e as g,t as p,k as v,c as y,a as b,g as w,d as L,n as x,b as D,L as k,f as $,H as I,M as E,N as T,O as S,l as z,I as N,P as O,Q as P,R as q,r as A,u as H,w as U,x as R,h as B,T as C,U as M,V as Y,j as V,m as j,o as J,v as F,W as X,X as W,Y as _,Z as Q,A as K,_ as Z,$ as G}from"../chunks/vendor-ba9074a1.js";const ee=new c("https://bqljggidsuurzwjgspix.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTYzMzc2MTI0MywiZXhwIjoxOTQ5MzM3MjQzfQ.lQzW2bbkwkN4IPf0QqJVHkTh_YJdd9mATglBUktRBpA",{});function te(e,t){document.cookie=`${e}=${JSON.stringify(t)}`}async function ae(e,t){const a=JSON.stringify(t),{data:s,error:n}=await ee.storage.from("images").upload(`${e.id}/frameData.txt`,a,{upsert:!0});n&&console.log(n)}async function se(e){const t=new Blob,{data:a,error:s}=await ee.storage.from("images").upload(`${e.id}/_blank.txt`,t,{upsert:!0});console.log(a),console.log(s)}let ne;function re(e,t,a){e.setItem(t,JSON.stringify(a))}function oe(e,t,a){let s=null;try{if(s=JSON.parse(e.getItem(t)),""==s)throw new Error("Smile empty soul");return s}catch(n){return console.warn(n),a}}function le(e){re(ne,"frameList",e.frameList),e.userData&&ae(e.userData,e.frameList),console.log("saved uwu ✨")}ne=window.localStorage;let ie=0;const ce=[{currentTrans:"",currentState:"",framesSnapshot:[]}],ue=d({currentTrans:"",currentState:"",framesSnapshot:[]});function de(){ue.update((()=>(ie+=1,ie===ce.length&&(ie=ce.length-1),ce[ie])))}function fe(e){ie+=1;const t=ce,a=i(l({},t[ie-1]),{framesSnapshot:e});t.push(a),ue.update((()=>a))}function he(e,t,a){return{currentTrans:"",currentState:e[t],framesSnapshot:a}}const me=new c("https://bqljggidsuurzwjgspix.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTYzMzc2MTI0MywiZXhwIjoxOTQ5MzM3MjQzfQ.lQzW2bbkwkN4IPf0QqJVHkTh_YJdd9mATglBUktRBpA",{});let ge,pe,ve;const ye=d({loggedIn:ge,userData:pe,sessionData:ve}),be=async()=>{const e=function(e){const t=document.cookie.split(";").find((t=>t.includes(`${e}=`)));return t?JSON.parse(t.split("=")[1]):null}("refreshToken"),{user:t,session:a,error:s}=await me.auth.signIn({refreshToken:e});return!s&&(te("refreshToken",a.refresh_token),await se(t),ye.update((()=>({userData:t,sessionData:a,loggedIn:!0}))),pe=t,ge=!0,ve=a,!0)},we=d({notifications:[]}),Le=[];let xe="",De=!1,ke=null;function $e(e){var t;(null==(t=null==e?void 0:e.interrupt)||t)&&(clearTimeout(ke),De=!1,Le.splice(0,100)),we.update((()=>(Le.push(e),{notifications:Le})))}we.subscribe((e=>{var t,a,s;const n=null!=(s=null==(a=null==(t=null==e?void 0:e.notifications)?void 0:t.at(0))?void 0:a.duration)?s:500;e.notifications.length>0&&0==De&&(De=!0,ke=setTimeout((()=>{var t;xe=null==(t=e.notifications)?void 0:t.at(0).notification,e.notifications.shift(),De=!1,we.update((()=>({notifications:e.notifications})))}),n),console.log(ke))}));const Ie={width:20,height:20,x:0,y:0};function Ee(e){return console.log(e),new Promise(((t,a)=>{e.url||a();const s=e.frameList.length;let n={url:e.url,width:400,height:400,x:100,y:100,style:"",id:s,topLeftHandle:Ie,topRightHandle:i(l({},Ie),{x:380}),bottomRightHandle:i(l({},Ie),{x:380,y:380}),bottomLeftHandle:i(l({},Ie),{y:380}),top:!0,active:!0,aspect:0,offset:[0,0]};const r=new Image;r.src=n.url,r.onload=()=>{console.log(r.naturalHeight,r.naturalWidth),n.height=r.naturalHeight,n.width=r.naturalWidth,n.aspect=n.width/n.height,n=Ne(n),n.style=Te(n),Ae(n),t(n)}}))}function Te(e,t){let a,s="",n=e.width,r=e.height;if(t)switch(t){case"tleft":n=e.topLeftHandle.width,r=e.topLeftHandle.height,a=` top: ${e.topLeftHandle.y}px; left: ${e.topLeftHandle.x}px;`;break;case"tright":n=e.topRightHandle.width,r=e.topRightHandle.height,a=` top: ${e.topRightHandle.y}px; left: ${e.topRightHandle.x}px;`;break;case"bleft":n=e.bottomLeftHandle.width,r=e.bottomLeftHandle.height,a=` top: ${e.bottomLeftHandle.y}px; left: ${e.bottomLeftHandle.x}px;`;break;case"bright":n=e.bottomRightHandle.width,r=e.bottomRightHandle.height,a=` top: ${e.bottomRightHandle.y}px; left: ${e.bottomRightHandle.x}px;`;break;default:return}return s=`width: ${n}px; height: ${r}px; position: fixed;`,t||(s+=` background-image: url('${e.url}'); top: ${e.y}px; left: ${e.x}px;`),t&&(s+=a),s}function Se(e){return e.map((e=>i(l({},e),{active:!1})))}function ze(e){return JSON.parse(JSON.stringify(e))}function Ne(e){const t=e.width/e.height;let a=window.visualViewport.width/2,s=window.visualViewport.width/2;return e.width>e.height?s=a/t:a=s*t,console.log(a,s,t),i(l({},e),{width:a,height:s})}function Oe(e){switch(e.frameList.filter((e=>1==e.active)),console.log(e.event),e.event.key){case"a":e.event.ctrlKey&&(e.frameList=e.frameList.map((e=>i(l({},e),{active:!0}))),fe(e.frameList),le({userData:e.userData,frameList:e.frameList}),$e({notification:"Select All"}));break;case"A":e.event.ctrlKey&&(e.frameList=Se(e.frameList),fe(e.frameList),le({userData:e.userData,frameList:e.frameList}),$e({notification:"Select All"}));break;case"y":e.event.ctrlKey&&(de(),$e({notification:"Redo"}));break;case"z":e.event.ctrlKey&&(t=e.userData,console.log("reversing history uwu ✨"),ue.update((()=>0==ie?(le({userData:t,frameList:[]}),null):ie>0?(ie-=1,console.log(ce[ie].framesSnapshot),le({userData:t,frameList:ce[ie].framesSnapshot}),ce[ie]):void 0)),$e({notification:"Undo"}));break;case"Z":e.event.ctrlKey&&(de(),$e({notification:"Undo"}));break;case"Escape":e.frameList=Se(e.frameList),fe(e.frameList),le({userData:e.userData,frameList:e.frameList}),$e({notification:"Select None"});break;case"Delete":case"Backspace":e.frameList=e.frameList.filter((e=>0==e.active)),fe(e.frameList),le({userData:e.userData,frameList:e.frameList}),$e({notification:"Cleared"});break;case"ArrowLeft":e.frameList=Pe(e.frameList,"left"),fe(e.frameList),le({userData:e.userData,frameList:e.frameList}),$e({notification:"Nudge Left",duration:300,interrupt:!0});break;case"ArrowRight":e.frameList=Pe(e.frameList,"right"),fe(e.frameList),le({userData:e.userData,frameList:e.frameList}),$e({notification:"Nudge Right",duration:300,interrupt:!0});break;case"ArrowUp":e.frameList=Pe(e.frameList,"up"),fe(e.frameList),le({userData:e.userData,frameList:e.frameList}),$e({notification:"Nudge Up",duration:300,interrupt:!0});break;case"ArrowDown":e.frameList=Pe(e.frameList,"down"),fe(e.frameList),le({userData:e.userData,frameList:e.frameList}),$e({notification:"Nudge Down",duration:300,interrupt:!0});break;case"-":e.event.ctrlKey&&(e.frameList=Be(i(l({},e),{zoom:"out"})),fe(e.frameList),le({userData:e.userData,frameList:e.frameList}),$e({notification:"Zoom Out",duration:300,interrupt:!0}));break;case"+":case"=":e.event.ctrlKey&&(e.frameList=Be(i(l({},e),{zoom:"in"})),fe(e.frameList),le({userData:e.userData,frameList:e.frameList}),$e({notification:"Zoom In",duration:300,interrupt:!0}))}var t;if(e.frameList)return e.frameList}function Pe(e,t){const a=40,s=function(e){return e.filter((e=>1==e.top))[0]}(e);switch(t){case"left":e[s.id].x=e[s.id].x-a-e[s.id].x%a,console.log(e[s.id].x);break;case"right":e[s.id].x=e[s.id].x+a-e[s.id].x%a;break;case"up":e[s.id].y=e[s.id].y-a-e[s.id].y%a;break;case"down":e[s.id].y=e[s.id].y+a-e[s.id].y%a}return Ae(s),e[s.id].style=Te(s),e}function qe(e,t,a){if("mouse"===(null==e?void 0:e.pointerType)){const a={x:0,y:0};a.x=e.movementX,a.y=e.movementY,t.x+=a.x,t.y+=a.y}else t.x=e.changedTouches[0].clientX-a[0],t.y=e.changedTouches[0].clientY-a[1],console.log(a[0]);return(t=Ae(t)).style=Te(t),t}function Ae(e){return e.topLeftHandle.x=e.x,e.topLeftHandle.y=e.y,e.topRightHandle.x=e.x+e.width-e.topRightHandle.width,e.topRightHandle.y=e.y,e.bottomLeftHandle.x=e.x,e.bottomLeftHandle.y=e.y+e.height-e.bottomLeftHandle.height,e.bottomRightHandle.x=e.x+e.width-e.bottomRightHandle.width,e.bottomRightHandle.y=e.y+e.height-e.bottomRightHandle.height,e}async function He(e){var t,a,s,n;const r=null==(a=null==(t=e.event)?void 0:t.clipboardData)?void 0:a.items[0].getAsFile();let o=null==(n=null==(s=e.event)?void 0:s.clipboardData)?void 0:n.getData("text");if(console.log(e.loggedIn),r)if(console.log("image pasted"),0==e.loggedIn||null==e.loggedIn){await async function(e){const t=new FileReader;let a;t.addEventListener("loadend",(s=>{a=t.result;let n=oe(e.appStorage,"localImages",[]);if(null!=n||(n=[]),0!=n.length||null!=n){const t=n.filter((t=>t.id==e.frameList.length));(t.length<1||null==t)&&(n.push({imageFile:e.imageFile,id:e.frameList.length,type:e.imageFile.type,text:a}),re(e.appStorage,"localImages",n))}0==n.length&&(n.push({imageFile:e.imageFile,id:e.frameList.length,type:e.imageFile.type,text:a}),re(e.appStorage,"localImages",n))})),t.readAsDataURL(e.imageFile)}({imageFile:r,frameList:e.frameList,appStorage:e.appStorage});const t=await function(e){let t=[];t=oe(e.appStorage,"localImages",[]),null==t&&(t=[]);const a=t.filter((t=>t.id==e.frameList.length))[0];return new Promise((e=>{e(a)}))}({appStorage:e.appStorage,frameList:e.frameList});o=t.text,console.log(o)}else{const{error:t,imageUrl:a}=await async function(e){const t=u(),{data:a,error:s}=await ee.storage.from("images").upload(`${e.userData.id}/${t}`,e.imageFile,{upsert:!0});if(s)return{error:s,imageUrl:null};{console.log(a.Key);const{error:s,publicURL:n}=await ee.storage.from("images").getPublicUrl(`${e.userData.id}/${t}`);return s?{error:s,imageUrl:null}:(console.log(n),{error:null,imageUrl:n})}}({userData:e.userData,imageFile:r});t?console.log(t):(o=a,console.log(o))}let l=await Ee({userData:e.userData,url:o,frameList:e.frameList});l.x=50,l.y=100,l.style=`position:fixed; left:${l.x}px; top:${l.y}px;`;const i=new Image;i.src=o,console.log(o),i.onload=()=>{console.log(i.naturalHeight,i.naturalWidth),l.height=i.naturalHeight,l.width=i.naturalWidth,l=Ne(l),l.style=Te(l),Ae(l),o&&(e.frameList=[...e.frameList,l]),e.frameList=Re(l.id,e.frameList),console.log(e.frameList.filter((e=>e.id==l.id))),fe(e.frameList)}}function Ue(e){return e.filter((e=>null!==e||void 0!==e))}function Re(e,t){return t.map((t=>t=t.id==e?i(l({},t),{top:!0,active:!0}):i(l({},t),{top:!1,active:!1})))}function Be(e){e.event.preventDefault();const t="in"==e.zoom.toLowerCase()?1.1:.9;return[...e.frameList].map((e=>(e.width*=t,e.height*=t,e.x*=t,e.y*=t,(e=Ae(e)).style=Te(e),e)))}function Ce(e){let t,a,s,n,r,o,l,i,c,u,d,f,h,m,z,N,O,P,q,A;return{c(){t=g("div"),a=g("button"),s=p("Delete"),o=v(),l=g("div"),u=v(),d=g("div"),m=v(),z=g("div"),N=p("Resize"),this.h()},l(e){t=y(e,"DIV",{class:!0,draggable:!0,style:!0});var n=b(t);a=y(n,"BUTTON",{class:!0});var r=b(a);s=w(r,"Delete"),r.forEach(L),n.forEach(L),o=x(e),l=y(e,"DIV",{class:!0,draggable:!0,style:!0}),b(l).forEach(L),u=x(e),d=y(e,"DIV",{class:!0,draggable:!0,style:!0}),b(d).forEach(L),m=x(e),z=y(e,"DIV",{class:!0,style:!0});var i=b(z);N=w(i,"Resize"),i.forEach(L),this.h()},h(){D(a,"class","svelte-qzwrll"),D(t,"class",n=k(`${e[3]} handle handle-tleft`)+" svelte-qzwrll"),D(t,"draggable","true"),D(t,"style",r=Te(e[0],"tleft")),D(l,"class",i=k(`${e[3]} handle handle-tright`)+" svelte-qzwrll"),D(l,"draggable","true"),D(l,"style",c=Te(e[0],"tright")),D(d,"class",f=k(`${e[3]} handle handle-bleft`)+" svelte-qzwrll"),D(d,"draggable","true"),D(d,"style",h=Te(e[0],"bleft")),D(z,"class",O=k(`${e[3]} handle handle-bright`)+" svelte-qzwrll"),D(z,"style",P=Te(e[0],"bright"))},m(n,r){$(n,t,r),I(t,a),I(a,s),$(n,o,r),$(n,l,r),$(n,u,r),$(n,d,r),$(n,m,r),$(n,z,r),I(z,N),q||(A=[E(a,"click",e[14]),E(t,"dragstart",e[15]),E(l,"dragstart",e[16]),E(d,"dragstart",e[17]),E(d,"dragover",T(e[18])),E(z,"pointerdown",e[19])],q=!0)},p(e,a){8&a&&n!==(n=k(`${e[3]} handle handle-tleft`)+" svelte-qzwrll")&&D(t,"class",n),1&a&&r!==(r=Te(e[0],"tleft"))&&D(t,"style",r),8&a&&i!==(i=k(`${e[3]} handle handle-tright`)+" svelte-qzwrll")&&D(l,"class",i),1&a&&c!==(c=Te(e[0],"tright"))&&D(l,"style",c),8&a&&f!==(f=k(`${e[3]} handle handle-bleft`)+" svelte-qzwrll")&&D(d,"class",f),1&a&&h!==(h=Te(e[0],"bleft"))&&D(d,"style",h),8&a&&O!==(O=k(`${e[3]} handle handle-bright`)+" svelte-qzwrll")&&D(z,"class",O),1&a&&P!==(P=Te(e[0],"bright"))&&D(z,"style",P)},d(e){e&&L(t),e&&L(o),e&&L(l),e&&L(u),e&&L(d),e&&L(m),e&&L(z),q=!1,S(A)}}}function Me(e){let t,a,s,n,r,o,l,i=e[0].active&&Ce(e);return{c(){t=g("div"),n=v(),i&&i.c(),r=z(),this.h()},l(e){t=y(e,"DIV",{class:!0,draggable:!0,style:!0}),b(t).forEach(L),n=x(e),i&&i.l(e),r=z(),this.h()},h(){var n;D(t,"class",a=k(`frame ${e[3]}`)+" svelte-qzwrll"),D(t,"draggable","true"),D(t,"style",s=null==(n=e[0])?void 0:n.style)},m(a,s){$(a,t,s),$(a,n,s),i&&i.m(a,s),$(a,r,s),o||(l=[E(t,"click",e[10]),E(t,"dragover",e[11]),E(t,"dragstart",e[12]),E(t,"dragend",e[13])],o=!0)},p(e,[n]){var o;8&n&&a!==(a=k(`frame ${e[3]}`)+" svelte-qzwrll")&&D(t,"class",a),1&n&&s!==(s=null==(o=e[0])?void 0:o.style)&&D(t,"style",s),e[0].active?i?i.p(e,n):(i=Ce(e),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},i:N,o:N,d(e){e&&L(t),e&&L(n),i&&i.d(e),e&&L(r),o=!1,S(l)}}}function Ye(e,t,a){let{userData:s}=t,{frame:n}=t,{frameList:r}=t,{addedClass:o=""}=t,l={x:0,y:0},i=[0,0],c=[0,0],u=` background-image: url('${null==n?void 0:n.url}');`;null==n||n.width,null==n||n.height,n.style=(null==n?void 0:n.style)+u;const d=e=>(e.dataTransfer.setData("frame id",n.id),e.dataTransfer.dropEffect="move",l.x=e.clientX,l.y=e.clientY,c=[n.x,n.y],a(4,i=[l.x-c[0],l.y-c[1]]),i),f=e=>(e.dataTransfer.getData("frame id"),l.x=e.pageX,l.y=e.pageY,c=[n.x,n.y],a(0,n.x=e.clientX-i[0],n),a(0,n.y=e.clientY-i[1],n),a(0,n.style=`width: ${n.width}px; height: ${n.height}px; position: fixed; left: ${n.x}px; top: ${n.y}px;`+u,n),a(0,n=Ae(n)),!1),h=(e,t)=>(e.dataTransfer.setData("frame id",n.id),l.x=e.clientX,l.y=e.clientY,c=[n.x,n.y],a(4,i=[l.x-n.x,l.y-n.y]),i),m=(e,t)=>{switch(e=e||window.event,console.log(e),l.x=e.movementX,l.y=e.movementY,t){case"bright":a(0,n.width=n.width+l.x,n),a(0,n.height=n.height+l.y,n),console.log(n.width,n.height);break;default:return}a(0,n=Ae(n))},g=O();function p(e,t,a){console.log("send"),g("message",{frame:e,event:t,edge:a})}return e.$$set=e=>{"userData"in e&&a(2,s=e.userData),"frame"in e&&a(0,n=e.frame),"frameList"in e&&a(1,r=e.frameList),"addedClass"in e&&a(3,o=e.addedClass)},[n,r,s,o,i,d,f,h,m,p,()=>{$e({notification:`Frame ID: ${n.id}`})},e=>f(e),e=>{a(4,i=d(e))},e=>le({userData:s,frameList:r}),e=>{a(1,r=r.filter((e=>0==e.top)))},e=>a(4,i=h(e)),e=>a(4,i=h(e)),e=>a(4,i=h(e)),e=>m(e,"bleft"),e=>{p(n,e,"bright")}]}class Ve extends f{constructor(e){super(),h(this,e,Ye,Me,m,{userData:2,frame:0,frameList:1,addedClass:3})}}function je(e){let t,a,s,n,r,o,l,i,c,u,d,f;return{c(){t=g("section"),a=g("input"),s=v(),n=g("div"),r=g("button"),o=g("span"),l=p("add"),i=v(),c=g("span"),u=p("Add Image"),this.h()},l(e){t=y(e,"SECTION",{id:!0,class:!0});var d=b(t);a=y(d,"INPUT",{id:!0,placeholder:!0,"aria-placeholder":!0,class:!0}),s=x(d),n=y(d,"DIV",{id:!0,class:!0});var f=b(n);r=y(f,"BUTTON",{class:!0});var h=b(r);o=y(h,"SPAN",{class:!0});var m=b(o);l=w(m,"add"),m.forEach(L),i=x(h),c=y(h,"SPAN",{class:!0});var g=b(c);u=w(g,"Add Image"),g.forEach(L),h.forEach(L),f.forEach(L),d.forEach(L),this.h()},h(){D(a,"id","textInput"),D(a,"placeholder","Enter image URL"),D(a,"aria-placeholder","Enter image URL"),D(a,"class","svelte-b8i4gs"),D(o,"class","material-icons"),D(c,"class","button-text svelte-b8i4gs"),D(r,"class","svelte-b8i4gs"),D(n,"id","submit"),D(n,"class","svelte-b8i4gs"),D(t,"id","inputArea"),D(t,"class","svelte-b8i4gs")},m(h,m){$(h,t,m),I(t,a),P(a,e[1]),I(t,s),I(t,n),I(n,r),I(r,o),I(o,l),I(r,i),I(r,c),I(c,u),d||(f=[E(a,"input",e[6]),E(a,"keypress",e[7]),E(r,"mousedown",e[8]),E(t,"click",T(e[5]))],d=!0)},p(e,[t]){2&t&&a.value!==e[1]&&P(a,e[1])},i:N,o:N,d(e){e&&L(t),d=!1,S(f)}}}function Je(e,t,a){var s=this&&this.__awaiter||function(e,t,a,s){return new(a||(a=Promise))((function(n,r){function o(e){try{i(s.next(e))}catch(t){r(t)}}function l(e){try{i(s.throw(e))}catch(t){r(t)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}i((s=s.apply(e,t||[])).next())}))};let{frameList:n}=t,{userData:r}=t,{keysLockedOut:o}=t,l="";const i=e=>s(void 0,void 0,void 0,(function*(){if("enter"==e.key.toLowerCase()){a(0,o=!1);let e=yield Ee({userData:r,url:l,frameList:n});a(3,n=[...n,e]),a(3,n=Re(e.id,n)),fe(n),a(1,l="")}}));return e.$$set=e=>{"frameList"in e&&a(3,n=e.frameList),"userData"in e&&a(4,r=e.userData),"keysLockedOut"in e&&a(0,o=e.keysLockedOut)},[o,l,i,n,r,function(t){q.call(this,e,t)},function(){l=this.value,a(1,l)},()=>{a(0,o=!0),i.bind(l)},e=>{a(0,o=!1),e.preventDefault(),i({key:"enter"})}]}class Fe extends f{constructor(e){super(),h(this,e,Je,je,m,{frameList:3,userData:4,keysLockedOut:0})}}function Xe(e){let t,a=(e[0]=!1)+"";return{c(){t=p(a)},l(e){t=w(e,a)},m(e,a){$(e,t,a)},p(e,s){1&s&&a!==(a=(e[0]=!1)+"")&&B(t,a)},i:N,o:N,d(e){e&&L(t)}}}function We(e){let t,a,s,n,r,o,l,i,c,u,d,f,h,m,k=(e[0]=!0)+"";function T(e,t){return e[12]?Qe:_e}let S=T(e),z=S(e),N=e[8]&&et(e),O=e[9]&&tt(),P=e[10]&&at(),q=e[11]&&st();return{c(){t=p(k),a=v(),s=g("div"),r=v(),o=g("div"),z.c(),l=v(),N&&N.c(),i=v(),O&&O.c(),c=v(),P&&P.c(),u=v(),q&&q.c(),this.h()},l(e){t=w(e,k),a=x(e),s=y(e,"DIV",{class:!0}),b(s).forEach(L),r=x(e),o=y(e,"DIV",{class:!0,id:!0});var n=b(o);z.l(n),l=x(n),N&&N.l(n),i=x(n),O&&O.l(n),c=x(n),P&&P.l(n),u=x(n),q&&q.l(n),n.forEach(L),this.h()},h(){D(s,"class","modal svelte-1vgqnhz"),D(o,"class","auth-dropdown svelte-1vgqnhz"),D(o,"id","auth-dropdown")},m(n,d){$(n,t,d),$(n,a,d),$(n,s,d),$(n,r,d),$(n,o,d),z.m(o,null),I(o,l),N&&N.m(o,null),I(o,i),O&&O.m(o,null),I(o,c),P&&P.m(o,null),I(o,u),q&&q.m(o,null),f=!0,h||(m=E(s,"click",e[15]),h=!0)},p(e,a){(!f||1&a)&&k!==(k=(e[0]=!0)+"")&&B(t,k),S===(S=T(e))&&z?z.p(e,a):(z.d(1),z=S(e),z&&(z.c(),z.m(o,l))),e[8]?N?N.p(e,a):(N=et(e),N.c(),N.m(o,i)):N&&(N.d(1),N=null),e[9]?O||(O=tt(),O.c(),O.m(o,c)):O&&(O.d(1),O=null),e[10]?P||(P=at(),P.c(),P.m(o,u)):P&&(P.d(1),P=null),e[11]?q||(q=st(),q.c(),q.m(o,null)):q&&(q.d(1),q=null)},i(e){f||(e&&C((()=>{n||(n=M(s,Y,{duration:100},!0)),n.run(1)})),e&&C((()=>{d||(d=M(o,Y,{duration:100},!0)),d.run(1)})),f=!0)},o(e){e&&(n||(n=M(s,Y,{duration:100},!1)),n.run(0)),e&&(d||(d=M(o,Y,{duration:100},!1)),d.run(0)),f=!1},d(e){e&&L(t),e&&L(a),e&&L(s),e&&n&&n.end(),e&&L(r),e&&L(o),z.d(),N&&N.d(),O&&O.d(),P&&P.d(),q&&q.d(),e&&d&&d.end(),h=!1,m()}}}function _e(e){let t,a,s,n=e[5]&&Ke(e),r=e[6]&&Ze(e),o=e[7]&&Ge(e);return{c(){n&&n.c(),t=v(),r&&r.c(),a=v(),o&&o.c(),s=z()},l(e){n&&n.l(e),t=x(e),r&&r.l(e),a=x(e),o&&o.l(e),s=z()},m(e,l){n&&n.m(e,l),$(e,t,l),r&&r.m(e,l),$(e,a,l),o&&o.m(e,l),$(e,s,l)},p(e,l){e[5]?n?n.p(e,l):(n=Ke(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null),e[6]?r?r.p(e,l):(r=Ze(e),r.c(),r.m(a.parentNode,a)):r&&(r.d(1),r=null),e[7]?o?o.p(e,l):(o=Ge(e),o.c(),o.m(s.parentNode,s)):o&&(o.d(1),o=null)},d(e){n&&n.d(e),e&&L(t),r&&r.d(e),e&&L(a),o&&o.d(e),e&&L(s)}}}function Qe(e){let t,a,s,n;return{c(){t=g("button"),a=p("Log Out"),this.h()},l(e){t=y(e,"BUTTON",{class:!0});var s=b(t);a=w(s,"Log Out"),s.forEach(L),this.h()},h(){D(t,"class","back-button span-both svelte-1vgqnhz")},m(r,o){$(r,t,o),I(t,a),s||(n=E(t,"click",e[16]),s=!0)},p:N,d(e){e&&L(t),s=!1,n()}}}function Ke(e){let t,a,s,n,r,o,l;return{c(){t=g("button"),a=p("Log In"),s=v(),n=g("button"),r=p("Sign Up"),this.h()},l(e){t=y(e,"BUTTON",{class:!0});var o=b(t);a=w(o,"Log In"),o.forEach(L),s=x(e),n=y(e,"BUTTON",{class:!0});var l=b(n);r=w(l,"Sign Up"),l.forEach(L),this.h()},h(){D(t,"class","svelte-1vgqnhz"),D(n,"class","svelte-1vgqnhz")},m(i,c){$(i,t,c),I(t,a),$(i,s,c),$(i,n,c),I(n,r),o||(l=[E(t,"click",e[17]),E(n,"click",e[18])],o=!0)},p:N,d(e){e&&L(t),e&&L(s),e&&L(n),o=!1,S(l)}}}function Ze(e){let t,a,s,n,r,o,l,i,c,u,d,f,h,m,k,T,z,N,O,q,A,H,U,R,B;return{c(){t=g("form"),a=g("label"),s=p("Email"),n=v(),r=g("input"),o=v(),l=g("label"),i=p("Password"),c=v(),u=g("input"),d=v(),f=g("button"),h=p("Submit"),m=v(),k=g("button"),T=p("Back"),z=v(),N=g("p"),O=g("span"),q=p("Don't have an account?"),A=v(),H=g("a"),U=p("Sign up here."),this.h()},l(e){t=y(e,"FORM",{class:!0});var g=b(t);a=y(g,"LABEL",{class:!0,for:!0});var p=b(a);s=w(p,"Email"),p.forEach(L),n=x(g),r=y(g,"INPUT",{class:!0,id:!0,type:!0}),o=x(g),l=y(g,"LABEL",{class:!0,for:!0});var v=b(l);i=w(v,"Password"),v.forEach(L),c=x(g),u=y(g,"INPUT",{class:!0,id:!0,type:!0}),d=x(g),f=y(g,"BUTTON",{class:!0});var D=b(f);h=w(D,"Submit"),D.forEach(L),g.forEach(L),m=x(e),k=y(e,"BUTTON",{class:!0});var $=b(k);T=w($,"Back"),$.forEach(L),z=x(e),N=y(e,"P",{class:!0});var I=b(N);O=y(I,"SPAN",{});var E=b(O);q=w(E,"Don't have an account?"),E.forEach(L),A=x(I),H=y(I,"A",{href:!0});var S=b(H);U=w(S,"Sign up here."),S.forEach(L),I.forEach(L),this.h()},h(){D(a,"class","left svelte-1vgqnhz"),D(a,"for","email"),D(r,"class","right svelte-1vgqnhz"),D(r,"id","email"),D(r,"type","email"),D(l,"class","left svelte-1vgqnhz"),D(l,"for","password"),D(u,"class","right svelte-1vgqnhz"),D(u,"id","password"),D(u,"type","password"),D(f,"class","span-both svelte-1vgqnhz"),f.value="submit",D(t,"class","span-both form svelte-1vgqnhz"),D(k,"class","back-button span-both svelte-1vgqnhz"),D(H,"href","#/"),D(N,"class","span-both svelte-1vgqnhz")},m(g,p){$(g,t,p),I(t,a),I(a,s),I(t,n),I(t,r),P(r,e[3]),I(t,o),I(t,l),I(l,i),I(t,c),I(t,u),P(u,e[2]),I(t,d),I(t,f),I(f,h),$(g,m,p),$(g,k,p),I(k,T),$(g,z,p),$(g,N,p),I(N,O),I(O,q),I(N,A),I(N,H),I(H,U),R||(B=[E(r,"input",e[19]),E(u,"input",e[20]),E(t,"submit",e[21]),E(k,"click",e[22]),E(H,"click",e[23])],R=!0)},p(e,t){8&t&&r.value!==e[3]&&P(r,e[3]),4&t&&u.value!==e[2]&&P(u,e[2])},d(e){e&&L(t),e&&L(m),e&&L(k),e&&L(z),e&&L(N),R=!1,S(B)}}}function Ge(e){let t,a,s,n,r,o,l,i,c,u,d,f,h,m,k,T,z,N,O,q,A,H,U,R,B,C,M,Y,V,j;return{c(){t=g("form"),a=g("label"),s=p("Name"),n=v(),r=g("input"),o=v(),l=g("label"),i=p("Email"),c=v(),u=g("input"),d=v(),f=g("label"),h=p("Password"),m=v(),k=g("input"),T=v(),z=g("button"),N=p("Submit"),O=v(),q=g("button"),A=p("Back"),H=v(),U=g("p"),R=g("span"),B=p("Already have an account?"),C=v(),M=g("a"),Y=p("Log in here."),this.h()},l(e){t=y(e,"FORM",{class:!0});var g=b(t);a=y(g,"LABEL",{class:!0,for:!0});var p=b(a);s=w(p,"Name"),p.forEach(L),n=x(g),r=y(g,"INPUT",{class:!0,id:!0}),o=x(g),l=y(g,"LABEL",{class:!0,for:!0});var v=b(l);i=w(v,"Email"),v.forEach(L),c=x(g),u=y(g,"INPUT",{class:!0,id:!0,type:!0}),d=x(g),f=y(g,"LABEL",{class:!0,for:!0});var D=b(f);h=w(D,"Password"),D.forEach(L),m=x(g),k=y(g,"INPUT",{class:!0,id:!0,type:!0}),T=x(g),z=y(g,"BUTTON",{class:!0});var $=b(z);N=w($,"Submit"),$.forEach(L),g.forEach(L),O=x(e),q=y(e,"BUTTON",{class:!0});var I=b(q);A=w(I,"Back"),I.forEach(L),H=x(e),U=y(e,"P",{class:!0});var E=b(U);R=y(E,"SPAN",{});var S=b(R);B=w(S,"Already have an account?"),S.forEach(L),C=x(E),M=y(E,"A",{href:!0});var P=b(M);Y=w(P,"Log in here."),P.forEach(L),E.forEach(L),this.h()},h(){D(a,"class","left svelte-1vgqnhz"),D(a,"for","name"),D(r,"class","right svelte-1vgqnhz"),D(r,"id","name"),D(l,"class","left svelte-1vgqnhz"),D(l,"for","email"),D(u,"class","right svelte-1vgqnhz"),D(u,"id","email"),D(u,"type","email"),D(f,"class","left svelte-1vgqnhz"),D(f,"for","password"),D(k,"class","right svelte-1vgqnhz"),D(k,"id","password"),D(k,"type","password"),D(z,"class","span-both svelte-1vgqnhz"),D(t,"class","span-both form svelte-1vgqnhz"),D(q,"class","back-button span-both svelte-1vgqnhz"),D(M,"href","#/"),D(U,"class","span-both svelte-1vgqnhz")},m(g,p){$(g,t,p),I(t,a),I(a,s),I(t,n),I(t,r),P(r,e[1]),I(t,o),I(t,l),I(l,i),I(t,c),I(t,u),P(u,e[3]),I(t,d),I(t,f),I(f,h),I(t,m),I(t,k),P(k,e[2]),I(t,T),I(t,z),I(z,N),$(g,O,p),$(g,q,p),I(q,A),$(g,H,p),$(g,U,p),I(U,R),I(R,B),I(U,C),I(U,M),I(M,Y),V||(j=[E(r,"input",e[24]),E(u,"input",e[25]),E(k,"input",e[26]),E(t,"submit",e[27]),E(q,"click",e[28]),E(M,"click",e[29])],V=!0)},p(e,t){2&t&&r.value!==e[1]&&P(r,e[1]),8&t&&u.value!==e[3]&&P(u,e[3]),4&t&&k.value!==e[2]&&P(k,e[2])},d(e){e&&L(t),e&&L(O),e&&L(q),e&&L(H),e&&L(U),V=!1,S(j)}}}function et(e){let t,a,s,n=`${e[8].message} :<`;return{c(){t=g("p"),a=g("span"),s=p(n),this.h()},l(e){t=y(e,"P",{class:!0});var r=b(t);a=y(r,"SPAN",{});var o=b(a);s=w(o,n),o.forEach(L),r.forEach(L),this.h()},h(){D(t,"class","span-both error svelte-1vgqnhz")},m(e,n){$(e,t,n),I(t,a),I(a,s)},p(e,t){256&t&&n!==(n=`${e[8].message} :<`)&&B(s,n)},d(e){e&&L(t)}}}function tt(e){let t,a,s;return{c(){t=g("p"),a=g("span"),s=p("Congrats! Check your email to validate your account :>"),this.h()},l(e){t=y(e,"P",{class:!0});var n=b(t);a=y(n,"SPAN",{});var r=b(a);s=w(r,"Congrats! Check your email to validate your account :>"),r.forEach(L),n.forEach(L),this.h()},h(){D(t,"class","span-both success svelte-1vgqnhz")},m(e,n){$(e,t,n),I(t,a),I(a,s)},d(e){e&&L(t)}}}function at(e){let t,a,s;return{c(){t=g("p"),a=g("span"),s=p("Congrats! You're now logged in :>"),this.h()},l(e){t=y(e,"P",{class:!0});var n=b(t);a=y(n,"SPAN",{});var r=b(a);s=w(r,"Congrats! You're now logged in :>"),r.forEach(L),n.forEach(L),this.h()},h(){D(t,"class","span-both success svelte-1vgqnhz")},m(e,n){$(e,t,n),I(t,a),I(a,s)},d(e){e&&L(t)}}}function st(e){let t,a,s;return{c(){t=g("p"),a=g("span"),s=p("Congrats! You've now logged out :>"),this.h()},l(e){t=y(e,"P",{class:!0});var n=b(t);a=y(n,"SPAN",{});var r=b(a);s=w(r,"Congrats! You've now logged out :>"),r.forEach(L),n.forEach(L),this.h()},h(){D(t,"class","span-both success svelte-1vgqnhz")},m(e,n){$(e,t,n),I(t,a),I(a,s)},d(e){e&&L(t)}}}function nt(e){let t,a,s,n,r,o,l,i,c,u;const d=[We,Xe],f=[];function h(e,t){return e[4]?0:1}return o=h(e),l=f[o]=d[o](e),{c(){t=g("div"),a=g("button"),s=g("span"),n=p("menu"),r=v(),l.c(),i=z(),this.h()},l(e){t=y(e,"DIV",{id:!0,class:!0});var o=b(t);a=y(o,"BUTTON",{class:!0});var c=b(a);s=y(c,"SPAN",{class:!0});var u=b(s);n=w(u,"menu"),u.forEach(L),c.forEach(L),o.forEach(L),r=x(e),l.l(e),i=z(),this.h()},h(){D(s,"class","material-icons"),D(a,"class","svelte-1vgqnhz"),D(t,"id","auth-menu"),D(t,"class","svelte-1vgqnhz")},m(l,d){$(l,t,d),I(t,a),I(a,s),I(s,n),$(l,r,d),f[o].m(l,d),$(l,i,d),c||(u=E(a,"click",e[14]),c=!0)},p(e,[t]){let a=o;o=h(e),o===a?f[o].p(e,t):(A(),H(f[a],1,1,(()=>{f[a]=null})),U(),l=f[o],l?l.p(e,t):(l=f[o]=d[o](e),l.c()),R(l,1),l.m(i.parentNode,i))},i(e){R(l)},o(e){H(l)},d(e){e&&L(t),e&&L(r),f[o].d(e),e&&L(i),c=!1,u()}}}function rt(){let e=document.getElementById("auth-dropdown"),t=0,a=setInterval((function(){t<3?(setTimeout((()=>{e.setAttribute("style","right:5px"),t+=1}),50),e.setAttribute("style","right:0px")):(clearInterval(a),t=0)}),100)}function ot(e,t,a){let s,n,r,o,l,i,c,u,d,f=!1,h=!1,m=!1,{keysLockedOut:g}=t;ye.subscribe((e=>{a(12,d=e.loggedIn)}));const p=()=>{a(9,f=!1),a(10,h=!1),a(8,u=null),a(11,m=!1)};return e.$$set=e=>{"keysLockedOut"in e&&a(0,g=e.keysLockedOut)},[g,s,n,r,o,l,i,c,u,f,h,m,d,p,()=>{a(0,g=!0),a(4,o=!0),a(5,l=!0),a(6,i=!1),a(7,c=!1),p()},()=>{a(0,g=!1),a(4,o=!1),p()},()=>{p(),a(11,m=!0),a(4,o=!0),a(6,i=!1),a(7,c=!1),a(5,l=!1),(async()=>{await me.auth.signOut(),ye.update((()=>({loggedIn:!1,userData:null,sessionData:null}))),te("refreshToken",null)})()},()=>{a(6,i=!0),a(7,c=!1),a(5,l=!1)},()=>{a(7,c=!0),a(6,i=!1),a(5,l=!1)},function(){r=this.value,a(3,r)},function(){n=this.value,a(2,n)},async e=>{e.preventDefault();const t=await(async e=>{const{user:t,session:a,error:s}=await me.auth.signIn({password:e.password,email:e.email});return s||(ge=!0,pe=t,ve=a,te("refreshToken",a.refresh_token),await se(t),ye.update((()=>({loggedIn:!0,userData:pe,sessionData:ve})))),{user:t,session:a,error:s}})({name:s,email:r,password:n});a(8,u=t.error),console.log(t),u&&rt(),t.error||a(10,h=!0)},()=>{a(6,i=!1),a(5,l=!0),p()},()=>{a(6,i=!1),a(7,c=!0),p()},function(){s=this.value,a(1,s)},function(){r=this.value,a(3,r)},function(){n=this.value,a(2,n)},async e=>{var t;e.preventDefault(),rt();const s=await(async e=>{const{user:t,session:a,error:s}=await me.auth.signUp({password:e.password,email:e.email});if(!s){ge=!0,ve=a;const{user:t,error:s}=await me.auth.update({data:{name:e.name}});s||(pe=t)}return{user:t,session:a,error:s}})({password:n,email:r});console.log(s),(null==(t=null==s?void 0:s.user)?void 0:t.confirmation_sent_at)&&(a(9,f=!0),a(7,c=!1)),(null==s?void 0:s.error)&&(a(8,u=s.error),rt())},()=>{a(7,c=!1),a(5,l=!0),p()},()=>{a(6,i=!0),a(7,c=!1),p()}]}class lt extends f{constructor(e){super(),h(this,e,ot,nt,m,{keysLockedOut:0})}}function it(e){let t,a,s;return{c(){t=g("div"),a=g("span"),s=p(e[0]),this.h()},l(n){t=y(n,"DIV",{class:!0});var r=b(t);a=y(r,"SPAN",{class:!0});var o=b(a);s=w(o,e[0]),o.forEach(L),r.forEach(L),this.h()},h(){D(a,"class","svelte-19btlg8"),D(t,"class","svelte-19btlg8")},m(e,n){$(e,t,n),I(t,a),I(a,s)},p(e,[t]){1&t&&B(s,e[0])},i:N,o:N,d(e){e&&L(t)}}}function ct(e,t,a){let s=xe;return we.subscribe((e=>{var t,n,r;a(0,s=null!==(r=null===(n=null===(t=null==e?void 0:e.notifications)||void 0===t?void 0:t.at(0))||void 0===n?void 0:n.notification)&&void 0!==r?r:"")})),[s]}class ut extends f{constructor(e){super(),h(this,e,ct,it,m,{})}}function dt(e){let t,a;return{c(){t=g("span"),a=p("Welcome to Polyref. Sign up above to access your ref board from anywhere!")},l(e){t=y(e,"SPAN",{});var s=b(t);a=w(s,"Welcome to Polyref. Sign up above to access your ref board from anywhere!"),s.forEach(L)},m(e,s){$(e,t,s),I(t,a)},p:N,d(e){e&&L(t)}}}function ft(e){let t,a,s;return{c(){t=g("span"),a=p("Welcome to Polyref! Logged in as: "),s=p(e[0])},l(n){t=y(n,"SPAN",{});var r=b(t);a=w(r,"Welcome to Polyref! Logged in as: "),s=w(r,e[0]),r.forEach(L)},m(e,n){$(e,t,n),I(t,a),I(t,s)},p(e,t){1&t&&B(s,e[0])},d(e){e&&L(t)}}}function ht(e){let t,a,s,n,r,o,l,i,c,u,d,f,h;function m(e,t){return e[1]?ft:dt}let k=m(e),E=k(e);return r=new ut({}),{c(){t=g("section"),a=g("div"),E.c(),s=v(),n=g("div"),V(r.$$.fragment),o=v(),l=g("div"),i=g("span"),c=p("info"),u=v(),d=g("span"),f=p("What is Polyref?"),this.h()},l(e){t=y(e,"SECTION",{id:!0,class:!0});var h=b(t);a=y(h,"DIV",{id:!0,class:!0});var m=b(a);E.l(m),m.forEach(L),s=x(h),n=y(h,"DIV",{});var g=b(n);j(r.$$.fragment,g),g.forEach(L),o=x(h),l=y(h,"DIV",{id:!0,class:!0});var p=b(l);i=y(p,"SPAN",{class:!0});var v=b(i);c=w(v,"info"),v.forEach(L),u=x(p),d=y(p,"SPAN",{});var D=b(d);f=w(D,"What is Polyref?"),D.forEach(L),p.forEach(L),h.forEach(L),this.h()},h(){D(a,"id","user-stuff"),D(a,"class","svelte-1xrws9x"),D(i,"class","material-icons"),D(l,"id","dock"),D(l,"class","svelte-1xrws9x"),D(t,"id","statusbar"),D(t,"class","svelte-1xrws9x")},m(e,m){$(e,t,m),I(t,a),E.m(a,null),I(t,s),I(t,n),J(r,n,null),I(t,o),I(t,l),I(l,i),I(i,c),I(l,u),I(l,d),I(d,f),h=!0},p(e,[t]){k===(k=m(e))&&E?E.p(e,t):(E.d(1),E=k(e),E&&(E.c(),E.m(a,null)))},i(e){h||(R(r.$$.fragment,e),h=!0)},o(e){H(r.$$.fragment,e),h=!1},d(e){e&&L(t),E.d(),F(r)}}}function mt(e,t,a){let s="",n=!1;return ye.subscribe((e=>{var t;a(0,s=null===(t=e.userData)||void 0===t?void 0:t.email),a(1,n=e.loggedIn)})),be().then((e=>a(1,n=e))),[s,n]}class gt extends f{constructor(e){super(),h(this,e,mt,ht,m,{})}}const{window:pt}=Z;function vt(e,t,a){const s=e.slice();return s[43]=t[a],s[44]=t,s[45]=a,s}function yt(e){let t,a,s;return{c(){t=g("div"),a=g("h1"),s=p("Loading..."),this.h()},l(e){t=y(e,"DIV",{});var n=b(t);a=y(n,"H1",{class:!0});var r=b(a);s=w(r,"Loading..."),r.forEach(L),n.forEach(L),this.h()},h(){D(a,"class","svelte-1fevhfa")},m(e,n){$(e,t,n),I(t,a),I(a,s)},p:N,i:N,o:N,d(e){e&&L(t)}}}function bt(e){let t,a,s=e[0],n=[];for(let o=0;o<s.length;o+=1)n[o]=xt(vt(e,s,o));const r=e=>H(n[e],1,1,(()=>{n[e]=null}));return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=z()},l(e){for(let t=0;t<n.length;t+=1)n[t].l(e);t=z()},m(e,s){for(let t=0;t<n.length;t+=1)n[t].m(e,s);$(e,t,s),a=!0},p(e,a){if(153&a[0]){let o;for(s=e[0],o=0;o<s.length;o+=1){const r=vt(e,s,o);n[o]?(n[o].p(r,a),R(n[o],1)):(n[o]=xt(r),n[o].c(),R(n[o],1),n[o].m(t.parentNode,t))}for(A(),o=s.length;o<n.length;o+=1)r(o);U()}},i(e){if(!a){for(let e=0;e<s.length;e+=1)R(n[e]);a=!0}},o(e){n=n.filter(Boolean);for(let t=0;t<n.length;t+=1)H(n[t]);a=!1},d(e){G(n,e),e&&L(t)}}}function wt(e){var t,a;let s,n,r,o,l,i,c,u;function d(t){e[22](t)}function f(t){e[23](t)}let h={addedClass:`${1==(null==(t=e[43])?void 0:t.top)?"zindexMax":""} ${1==(null==(a=e[43])?void 0:a.active)?"active":""}`,frame:e[43]};function m(...t){return e[25](e[43],e[44],e[45],...t)}return void 0!==e[0]&&(h.frameList=e[0]),void 0!==e[7]&&(h.userData=e[7]),n=new Ve({props:h}),X.push((()=>W(n,"frameList",d))),X.push((()=>W(n,"userData",f))),n.$on("message",e[24]),{c(){s=g("div"),V(n.$$.fragment),l=v()},l(e){s=y(e,"DIV",{});var t=b(s);j(n.$$.fragment,t),l=x(t),t.forEach(L)},m(e,t){$(e,s,t),J(n,s,null),I(s,l),i=!0,c||(u=E(s,"pointerdown",m),c=!0)},p(t,a){var s,l;e=t;const i={};1&a[0]&&(i.addedClass=`${1==(null==(s=e[43])?void 0:s.top)?"zindexMax":""} ${1==(null==(l=e[43])?void 0:l.active)?"active":""}`),1&a[0]&&(i.frame=e[43]),!r&&1&a[0]&&(r=!0,i.frameList=e[0],Q((()=>r=!1))),!o&&128&a[0]&&(o=!0,i.userData=e[7],Q((()=>o=!1))),n.$set(i)},i(e){i||(R(n.$$.fragment,e),i=!0)},o(e){H(n.$$.fragment,e),i=!1},d(e){e&&L(s),F(n),c=!1,u()}}}function Lt(e){let t,a=(e[0]=Ue(e[0]))+"";return{c(){t=p(a)},l(e){t=w(e,a)},m(e,a){$(e,t,a)},p(e,s){1&s[0]&&a!==(a=(e[0]=Ue(e[0]))+"")&&B(t,a)},i:N,o:N,d(e){e&&L(t)}}}function xt(e){let t,a,s,n;const r=[Lt,wt],o=[];function l(e,t){return null==e[43]?0:1}return t=l(e),a=o[t]=r[t](e),{c(){a.c(),s=z()},l(e){a.l(e),s=z()},m(e,a){o[t].m(e,a),$(e,s,a),n=!0},p(e,n){let i=t;t=l(e),t===i?o[t].p(e,n):(A(),H(o[i],1,1,(()=>{o[i]=null})),U(),a=o[t],a?a.p(e,n):(a=o[t]=r[t](e),a.c()),R(a,1),a.m(s.parentNode,s))},i(e){n||(R(a),n=!0)},o(e){H(a),n=!1},d(e){o[t].d(e),e&&L(s)}}}function Dt(e){let t,a,s,n,r,o,l,i,c,u,d,f,h,m,p,w,k;function z(t){e[18](t)}function N(t){e[19](t)}function O(t){e[20](t)}let P={};function q(t){e[21](t)}void 0!==e[13]&&(P.keysLockedOut=e[13]),void 0!==e[0]&&(P.frameList=e[0]),void 0!==e[7]&&(P.userData=e[7]),a=new Fe({props:P}),X.push((()=>W(a,"keysLockedOut",z))),X.push((()=>W(a,"frameList",N))),X.push((()=>W(a,"userData",O)));let B={};void 0!==e[13]&&(B.keysLockedOut=e[13]),l=new lt({props:B}),X.push((()=>W(l,"keysLockedOut",q)));const C=[bt,yt],M=[];function Y(e,t){var a;return(null==(a=e[0])?void 0:a.length)>0?0:e[8]?1:-1}return~(d=Y(e))&&(f=M[d]=C[d](e)),m=new gt({}),{c(){t=g("main"),V(a.$$.fragment),o=v(),V(l.$$.fragment),c=v(),u=g("div"),f&&f.c(),h=v(),V(m.$$.fragment),this.h()},l(e){t=y(e,"MAIN",{class:!0});var s=b(t);j(a.$$.fragment,s),o=x(s),j(l.$$.fragment,s),c=x(s),u=y(s,"DIV",{id:!0,class:!0});var n=b(u);f&&f.l(n),n.forEach(L),h=x(s),j(m.$$.fragment,s),s.forEach(L),this.h()},h(){D(u,"id","dropzone"),D(u,"class","svelte-1fevhfa"),D(t,"class","svelte-1fevhfa")},m(s,n){$(s,t,n),J(a,t,null),I(t,o),J(l,t,null),I(t,c),I(t,u),~d&&M[d].m(u,null),e[27](u),I(t,h),J(m,t,null),p=!0,w||(k=[E(pt,"keydown",e[17]),E(u,"click",e[26]),E(u,"dragover",_(T(kt))),E(u,"drop",_(T(e[28]))),E(u,"paste",e[29]),E(u,"touchstart",e[30]),E(u,"touchmove",e[31]),E(u,"pointerdown",e[32]),E(u,"pointermove",e[33]),E(u,"pointerup",e[34])],w=!0)},p(e,t){const o={};!s&&8192&t[0]&&(s=!0,o.keysLockedOut=e[13],Q((()=>s=!1))),!n&&1&t[0]&&(n=!0,o.frameList=e[0],Q((()=>n=!1))),!r&&128&t[0]&&(r=!0,o.userData=e[7],Q((()=>r=!1))),a.$set(o);const c={};!i&&8192&t[0]&&(i=!0,c.keysLockedOut=e[13],Q((()=>i=!1))),l.$set(c);let h=d;d=Y(e),d===h?~d&&M[d].p(e,t):(f&&(A(),H(M[h],1,1,(()=>{M[h]=null})),U()),~d?(f=M[d],f?f.p(e,t):(f=M[d]=C[d](e),f.c()),R(f,1),f.m(u,null)):f=null)},i(e){p||(R(a.$$.fragment,e),R(l.$$.fragment,e),R(f),R(m.$$.fragment,e),p=!0)},o(e){H(a.$$.fragment,e),H(l.$$.fragment,e),H(f),H(m.$$.fragment,e),p=!1},d(s){s&&L(t),F(a),F(l),~d&&M[d].d(),e[27](null),F(m),w=!1,S(k)}}}const kt=e=>!1;function $t(e,t,a){var s=this&&this.__awaiter||function(e,t,a,s){return new(a||(a=Promise))((function(n,r){function o(e){try{i(s.next(e))}catch(t){r(t)}}function l(e){try{i(s.throw(e))}catch(t){r(t)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}i((s=s.apply(e,t||[])).next())}))};let n,r,o,l=[],i={x:0,y:0},c=null,u="",d=!1,f=null,h=!0;K((()=>s(void 0,void 0,void 0,(function*(){ye.subscribe((e=>s(void 0,void 0,void 0,(function*(){if(a(6,d=e.loggedIn),a(7,f=e.userData),d){console.log("did fetch");const{fetchedFrameList:t,error:a}=yield async function(e){const{data:t,error:a}=await ee.storage.from("images").download(`${e.id}/frameData.txt`);if(a)return{fetchedFrameList:null,error:a};{const e=await t.text();try{return 0==e.length?(console.log(JSON.parse(e)),{fetchedFrameList:null,error:null}):{fetchedFrameList:JSON.parse(e),error:null}}catch(s){return{fetchedFrameList:null,error:s}}}}(e.userData);a?console.log(a):0!=t.length&&fe(t)}})))),ue.subscribe((e=>s(void 0,void 0,void 0,(function*(){e?(a(0,n=e.framesSnapshot),a(0,n=n.map((e=>(e=Ae(e),Object.assign(Object.assign({},e),{style:Te(e)}))))),console.log(n),d&&(yield ae(pe,n))):a(0,n=[])})))),a(6,d=yield be()),a(8,h=!1),a(5,o=window.localStorage),0==d&&(a(0,n=oe(o,"frameList",n)),console.log(n),a(1,r=n?ze(n):[])),(0==d&&null===n||void 0===n||0==(null==n?void 0:n.length))&&(a(0,n=new Array),Ee({userData:f,url:"https://c.pxhere.com/images/8c/33/1bb3e98042854d9eee207eb9facc-1622223.jpg!d",frameList:n}).then((e=>{e.x=50,e.y=100,e.style=Te(e),e=Ae(e),n.push(e),a(0,n=Re(e.id,n)),fe(n)}))),fe(n),l=[{currentTrans:"",currentState:he(l,0,n),framesSnapshot:n}]}))));const m=(e,t)=>s(void 0,void 0,void 0,(function*(){if(console.log("dropped"),e.preventDefault(),e.dataTransfer.items){let t=e.dataTransfer.items[0].getAsFile();if(t&&t.type.includes("image")){let e=URL.createObjectURL(t),s=yield Ee({url:e,userData:f,frameList:n});s.x=50,s.y=100,s.style=Te(s),s=Ae(s),a(0,n=[...n,s]),fe(n)}}if(!e.dataTransfer.getData("frame id")){let t=e.dataTransfer.getData("text"),s=yield Ee({url:t,userData:f,frameList:n});s.x=e.clientX,s.y=e.clientY,s.style=`position:fixed; left:${s.x}px; top:${s.y}px;`;let r=n;t&&(r=[...r,s]),r=Re(s.id,r),a(0,n=r),fe(n)}"move"==e.dataTransfer.dropEffect&&(console.log("moved"),e.dataTransfer.getData("frame id"),fe(n))}));let g,p=!1,v=!1,y=1;const b=()=>{a(9,p=!0)},w=()=>{a(9,p=!1),a(3,c=null)};O();let L=!1;return[n,r,i,c,u,o,d,f,h,p,v,g,y,L,m,b,w,e=>{0==d&&a(7,f=null),0==L&&Oe({userData:f,event:e,frameList:n})},function(e){L=e,a(13,L)},function(e){n=e,a(0,n)},function(e){f=e,a(7,f)},function(e){L=e,a(13,L)},function(e){n=e,a(0,n)},function(e){f=e,a(7,f)},e=>{var t,s;let n=e;a(3,c=null==(t=null==n?void 0:n.detail)?void 0:t.frame.id),a(4,u=null==(s=null==n?void 0:n.detail)?void 0:s.edge)},(e,t,s,r)=>{("touch"==r.pointerType&&r.isPrimary||"mouse"==r.pointerType)&&(a(0,t[s]=Ae(e),n),a(0,n=Re(e.id,n)))},()=>{a(13,L=!1)},function(e){X[e?"unshift":"push"]((()=>{g=e,a(11,g)}))},e=>m(e),async e=>{try{await He({userData:f,frameList:n,event:e,appStorage:o,loggedIn:d})}catch(t){console.log(t)}},e=>{if(e.preventDefault(),e.targetTouches.length>1)try{let t=e.targetTouches[0],s=e.targetTouches[1],o=Math.abs(t.clientX-s.clientX),l=Math.abs(t.clientY-s.clientY);a(12,y=Math.sqrt(o**2+l**2)),a(1,r=ze(n))}catch(t){console.log(t)}},e=>{var t;2==e.targetTouches.length&&a(0,n=function(e,t,a){t.preventDefault();const s={transfomScale:1,center:[200,200]},n=t.targetTouches[0],r=t.targetTouches[1],o=Math.abs(n.clientX-r.clientX),l=Math.abs(n.clientY-r.clientY);s.transfomScale=Math.sqrt(o**2+l**2);const i=s.transfomScale/a;return[...e].map((e=>(e.width*=i,e.height*=i,e.x*=i,e.y*=i,(e=Ae(e)).style=Te(e),e)))}(ze(r),e,y)),v&&1==(null==(t=null==e?void 0:e.changedTouches)?void 0:t.length)&&a(0,n=n.map((t=>t=qe(e,t,t.offset))))},e=>{"dropzone"==e.target.id?(("touch"==e.pointerType&&e.isPrimary||"mouse"==e.pointerType)&&a(0,n=Se(n)),"touch"==e.pointerType&&(e.isPrimary?a(10,v=!0):a(10,v=!1)),"mouse"==e.pointerType&&a(10,v=!0),a(0,n=n.map((t=>(t.offset=[e.clientX-t.x,e.clientY-t.y],t))))):b()},e=>{1==p&&n[c]&&a(0,n[c]=function(e,t,a){let s=a[t];const n=s.x,r=(s.y,{x:0,y:0});switch(e.pointerType){case"touch":console.log(e),s.width=e.clientX-n,s.height=s.width/s.aspect;break;default:case"mouse":r.x=e.movementX,r.y=e.movementY,s.width+=r.x,s.height+=r.x/s.aspect,s.bottomRightHandle.x+=r.x,s.bottomRightHandle.y+=s.height}return s=Ae(s),s.style=Te(s),s}(e,c,n),n),v&&"mouse"===(null==e?void 0:e.pointerType)&&a(0,n=n.map((t=>t=qe(e,t,t.offset))))},e=>{w(),a(10,v=!1),fe(n),le({userData:f,frameList:n})}]}class It extends f{constructor(e){super(),h(this,e,$t,Dt,m,{},null,[-1,-1])}}export{It as default};
